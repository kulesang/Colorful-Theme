import{z as w,b as st,u as et,e as l,c as j,h as ot,i as c,j as a,l as n,k as v,t as s,m as h,F as L,a as q,p as H,w as r,y as S,s as b,o as d,q as y,B as nt}from"./index-BHTMErf9.js";import{v as it,w as lt,x as dt,y as rt,z as ct,A as ut}from"./user-CAmOVogg.js";import{U as vt}from"./users-BuWGWSZW.js";import{W as ht}from"./wallet-B0AMO1nV.js";import{P as mt}from"./plus-B4U0APJw.js";import{C as _t}from"./copy-Df0ta2DO.js";import"./request-BDShSQSj.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=w("arrow-right-left",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=w("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=w("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=w("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=w("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),wt={class:"invitations-page"},kt={class:"page-header"},$t={class:"header-icon"},Ct={key:0,class:"loading-state"},zt={class:"invite-stats-grid"},At={class:"stat-card glass-card"},Lt={class:"stat-icon commission-count"},Ut={class:"stat-content"},Ft={class:"stat-value"},It={class:"stat-label"},Tt={class:"stat-card glass-card"},Mt={class:"stat-icon commission-earned"},St={class:"stat-content"},Dt={class:"stat-value"},Bt={class:"stat-label"},Vt={class:"stat-card glass-card"},Nt={class:"stat-icon commission-rate"},Pt={class:"stat-content"},Ot={class:"stat-value"},Rt={class:"stat-label"},Wt={class:"stat-card glass-card highlight balance-card"},jt={class:"balance-info"},qt={class:"stat-icon commission-balance"},Ht={class:"stat-content"},xt={class:"stat-value"},Et={class:"stat-label"},Gt={class:"balance-action"},Jt={class:"modal-form"},Kt={class:"modal-tip"},Qt={class:"input-wrapper"},Xt={class:"input-label"},Yt={class:"amount-actions"},Zt={class:"max-amount"},ta={class:"modal-form"},aa={class:"modal-tip"},sa={class:"input-wrapper",style:{"margin-bottom":"20px"}},ea={class:"input-label"},oa={class:"input-wrapper",style:{"margin-bottom":"20px"}},na={class:"input-label"},ia={class:"input-wrapper"},la={class:"input-label"},da={class:"amount-actions"},ra={class:"max-amount"},ca={class:"invite-link-card glass-card"},ua={class:"card-header"},va={key:0,class:"link-box-wrapper"},ha={class:"code-badge"},ma=["value"],_a=["onClick"],pa={key:1,class:"empty-codes"},ba={class:"link-desc"},ya={class:"invite-list-card glass-card"},fa={class:"card-header"},ga={class:"record-count"},wa={class:"record-list"},ka={key:0,class:"empty-records"},$a={class:"record-info"},Ca={class:"record-user"},za={class:"record-date"},Aa={key:0,class:"pagination-wrapper"},La={__name:"Invitations",setup(Ua){const{t:m}=et(),k=l(null),D=l(!0),U=l(!1),$=l(null),x=async()=>{try{const t=await dt();t.data&&($.value=t.data)}catch{}},C=l(!1),_=l(null),F=l(!1),E=async()=>{if(!_.value||_.value<1){b.warning(m("dashboard.invitations.minTransfer"));return}F.value=!0;try{(await rt({transfer_amount:_.value*100})).data&&(b.success(m("dashboard.invitations.transferSuccess")),C.value=!1,_.value=null,M())}catch{}finally{F.value=!1}},z=l(!1),I=l(!1),i=l({method:"",account:"",amount:null}),G=async()=>{if(!i.value.method||!i.value.account||!i.value.amount){b.warning(m("common.fillAllFields"));return}I.value=!0;try{(await ct({withdraw_method:i.value.method,withdraw_account:`${i.value.account} (${m("dashboard.invitations.transferAmount")}: ¥${i.value.amount})`})).data&&(b.success(m("dashboard.invitations.withdrawSuccess")),z.value=!1,i.value={method:"",account:"",amount:null})}catch{}finally{I.value=!1}},u=j(()=>{var o;if(!((o=k.value)!=null&&o.stat))return{commission_count:0,earned_commission:0,pending_commission:0,commission_rate:0,commission_balance:0};const t=k.value.stat;return{commission_count:t[0]||0,earned_commission:t[1]||0,pending_commission:t[2]||0,commission_rate:t[3]||0,commission_balance:t[4]||0}}),B=j(()=>{var t;return((t=k.value)==null?void 0:t.codes)||[]}),T=l(1),A=l(0),V=l(10),f=l([]),N=async()=>{try{const t=await lt({current:T.value,page_size:V.value});t.data&&Array.isArray(t.data)?(f.value=t.data,A.value=t.total||t.data.length):t.data&&t.data.data&&Array.isArray(t.data.data)?(f.value=t.data.data,A.value=t.data.total):f.value=[]}catch(t){console.error(t)}},P=t=>window.location.origin+"/#/register?code="+t,M=async()=>{try{const t=await it();t.data&&(k.value=t.data)}catch{b.error(m("common.copyFailed"))}finally{D.value=!1}};ot(()=>{M(),N(),x()});const J=async()=>{U.value=!0;try{(await ut()).data&&(b.success(m("dashboard.invitations.generateSuccess")),M())}catch{}finally{U.value=!1}},K=t=>t?new Date(t*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"--",Q=t=>{navigator.clipboard.writeText(t),b.success("邀请链接已复制")};return(t,o)=>{var W;const X=h("a-spin"),g=h("a-button"),O=h("a-input-number"),R=h("a-modal"),Y=h("a-select-option"),Z=h("a-select"),tt=h("a-input"),at=h("a-pagination");return d(),c("div",wt,[a("div",kt,[a("div",$t,[n(v(vt),{size:32})]),a("h1",null,s(t.$t("dashboard.invitations.title")),1),a("p",null,s(t.$t("dashboard.invitations.description")),1)]),D.value?(d(),c("div",Ct,[n(X,{size:"large"})])):(d(),c(L,{key:1},[a("div",zt,[a("div",At,[a("div",Lt,[n(v(gt),{size:24})]),a("div",Ut,[a("div",Ft,s(u.value.commission_count),1),a("div",It,s(t.$t("dashboard.invitations.stats.count")),1)])]),a("div",Tt,[a("div",Mt,[n(v(yt),{size:24})]),a("div",St,[a("div",Dt,"¥"+s((u.value.earned_commission/100).toFixed(2)),1),a("div",Bt,s(t.$t("dashboard.invitations.stats.earned")),1)])]),a("div",Vt,[a("div",Nt,[n(v(ft),{size:24})]),a("div",Pt,[a("div",Ot,s(u.value.commission_rate)+"%",1),a("div",Rt,s(t.$t("dashboard.invitations.stats.rate")),1)])]),a("div",Wt,[a("div",jt,[a("div",qt,[n(v(ht),{size:24})]),a("div",Ht,[a("div",xt,"¥"+s((u.value.commission_balance/100).toFixed(2)),1),a("div",Et,s(t.$t("dashboard.invitations.stats.balance")),1)])]),a("div",Gt,[n(g,{class:"action-btn transfer-btn",type:"primary",onClick:o[0]||(o[0]=e=>C.value=!0),disabled:u.value.commission_balance<=0},{icon:r(()=>[n(v(pt),{size:16})]),default:r(()=>[y(" "+s(t.$t("dashboard.invitations.transfer")),1)]),_:1},8,["disabled"]),!$.value||!((W=$.value)!=null&&W.withdraw_close)?(d(),q(g,{key:0,class:"action-btn withdraw-btn",onClick:o[1]||(o[1]=e=>z.value=!0),disabled:u.value.commission_balance<=0},{icon:r(()=>[n(v(bt),{size:16})]),default:r(()=>[y(" "+s(t.$t("dashboard.invitations.withdraw")),1)]),_:1},8,["disabled"])):H("",!0)])])]),n(R,{visible:C.value,"onUpdate:visible":o[4]||(o[4]=e=>C.value=e),title:t.$t("dashboard.invitations.transferTitle"),onOk:E,confirmLoading:F.value,destroyOnClose:""},{default:r(()=>[a("div",Jt,[a("p",Kt,s(t.$t("dashboard.invitations.transferDesc")),1),a("div",Qt,[a("div",Xt,s(t.$t("dashboard.invitations.transferAmount")),1),n(O,{value:_.value,"onUpdate:value":o[2]||(o[2]=e=>_.value=e),min:1,step:1,style:{width:"100%"},placeholder:"0.00"},{prefix:r(()=>[...o[11]||(o[11]=[y("¥",-1)])]),_:1},8,["value"]),a("div",Yt,[a("span",Zt,s(t.$t("dashboard.invitations.stats.balance"))+": ¥"+s((u.value.commission_balance/100).toFixed(2)),1),n(g,{type:"link",size:"small",onClick:o[3]||(o[3]=e=>_.value=u.value.commission_balance/100)},{default:r(()=>[y(s(t.$t("dashboard.invitations.allTransfer")),1)]),_:1})])])])]),_:1},8,["visible","title","confirmLoading"]),n(R,{visible:z.value,"onUpdate:visible":o[9]||(o[9]=e=>z.value=e),title:t.$t("dashboard.invitations.withdrawTitle"),onOk:G,confirmLoading:I.value,destroyOnClose:""},{default:r(()=>[a("div",ta,[a("p",aa,s(t.$t("dashboard.invitations.withdrawDesc")),1),a("div",sa,[a("div",ea,s(t.$t("dashboard.invitations.withdrawMethod")),1),n(Z,{value:i.value.method,"onUpdate:value":o[5]||(o[5]=e=>i.value.method=e),style:{width:"100%"},placeholder:"Select method"},{default:r(()=>{var e;return[(d(!0),c(L,null,S((e=$.value)==null?void 0:e.withdraw_methods,p=>(d(),q(Y,{key:p,value:p},{default:r(()=>[y(s(p),1)]),_:2},1032,["value"]))),128))]}),_:1},8,["value"])]),a("div",oa,[a("div",na,s(t.$t("dashboard.invitations.withdrawAccount")),1),n(tt,{value:i.value.account,"onUpdate:value":o[6]||(o[6]=e=>i.value.account=e),placeholder:t.$t("dashboard.invitations.withdrawAccount")},null,8,["value","placeholder"])]),a("div",ia,[a("div",la,s(t.$t("dashboard.invitations.transferAmount"))+" (¥)",1),n(O,{value:i.value.amount,"onUpdate:value":o[7]||(o[7]=e=>i.value.amount=e),min:1,step:1,style:{width:"100%"},placeholder:"0.00"},null,8,["value"]),a("div",da,[a("span",ra,s(t.$t("dashboard.invitations.stats.balance"))+": ¥"+s((u.value.commission_balance/100).toFixed(2)),1),n(g,{type:"link",size:"small",onClick:o[8]||(o[8]=e=>i.value.amount=u.value.commission_balance/100)},{default:r(()=>[y(s(t.$t("dashboard.invitations.allTransfer")),1)]),_:1})])])])]),_:1},8,["visible","title","confirmLoading"]),a("div",ca,[a("div",ua,[a("h3",null,s(t.$t("dashboard.invitations.linkTitle")),1),n(g,{type:"primary",class:"generate-btn",loading:U.value,onClick:J},{icon:r(()=>[n(v(mt),{size:16})]),default:r(()=>[y(" "+s(t.$t("dashboard.invitations.generate")),1)]),_:1},8,["loading"])]),B.value.length>0?(d(),c("div",va,[(d(!0),c(L,null,S(B.value,(e,p)=>(d(),c("div",{key:p,class:"link-box"},[a("div",ha,s(e.code),1),a("input",{value:P(e.code),readonly:"",class:"link-input"},null,8,ma),a("button",{class:"copy-btn",onClick:Fa=>Q(P(e.code))},[n(v(_t),{size:18}),a("span",null,s(t.$t("dashboard.invitations.copy")),1)],8,_a)]))),128))])):(d(),c("div",pa,[a("p",null,s(t.$t("dashboard.invitations.emptyCode")),1)])),a("p",ba,s(t.$t("dashboard.invitations.desc")),1)]),a("div",ya,[a("div",fa,[a("h3",null,s(t.$t("dashboard.invitations.recordTitle")),1),a("span",ga,s(t.$t("dashboard.invitations.totalRecords",{count:f.value.length})),1)]),a("div",wa,[f.value.length===0?(d(),c("div",ka,s(t.$t("dashboard.invitations.noRecords")),1)):(d(!0),c(L,{key:1},S(f.value,(e,p)=>(d(),c("div",{key:p,class:"record-item"},[a("div",$a,[a("div",Ca,s(t.$t("dashboard.invitations.orderParams",{id:e.trade_no})),1),a("div",za,s(t.$t("dashboard.invitations.orderAmount"))+": ¥"+s((e.order_amount/100).toFixed(2))+" | "+s(K(e.created_at)),1)]),a("div",{class:nt(["record-status",{confirmed:e.get_amount>0}])},s(e.get_amount>0?`+¥${(e.get_amount/100).toFixed(2)}`:t.$t("dashboard.invitations.statusPending")),3)]))),128))]),A.value>0?(d(),c("div",Aa,[n(at,{current:T.value,"onUpdate:current":o[10]||(o[10]=e=>T.value=e),total:A.value,pageSize:V.value,onChange:N,"show-less-items":""},null,8,["current","total","pageSize"])])):H("",!0)])],64))])}}},Na=st(La,[["__scopeId","data-v-5a736452"]]);export{Na as default};
