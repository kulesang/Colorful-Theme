import{u as x,r as h,n as w,o as F,v as K,D as b,c as o,b as t,k as c,e as d,d as u,t as n,F as M,x as T,f as C,w as z,i as r,l as $}from"./index-DBj0bk-v.js";import{d as q}from"./user-DXsAa-Hk.js";import{d as N,C as E,a as I}from"./marked.esm-xeqMxzF5.js";import{_ as O}from"./_plugin-vue_export-helper-tGYcrXWe.js";import{B as D}from"./book-open-AJSfkDeC.js";import{F as S}from"./file-text-CvdoPeR-.js";import"./createLucideIcon-CI9fqIqV.js";const H={class:"knowledge-page"},R={class:"page-header"},U={class:"header-icon"},j={key:0,class:"knowledge-grid"},G=["onClick"],J={class:"card-icon"},P={class:"card-content"},Q={class:"card-title"},W={key:0,class:"card-desc"},X={class:"card-meta"},Y={class:"meta-item"},Z={key:0,class:"category-tag"},ee={class:"card-arrow"},te={key:1,class:"loading-state"},se={key:2,class:"empty-state"},ae={class:"modal-title"},oe=["innerHTML"],ne={__name:"Knowledge",setup(re){const{locale:k}=x(),p=K();N.setOptions({breaks:!0,gfm:!0,headerIds:!0,mangle:!1});const _=h({}),v=h(!0),m=h(!1),l=h(null),i=w(()=>{const e=[];return Object.keys(_.value).forEach(a=>{Array.isArray(_.value[a])&&_.value[a].forEach(f=>{e.push({...f,category:a})})}),e});F(async()=>{await L(),g()});const L=async()=>{try{const e=await q({language:k.value==="zh-CN"?"zh-CN":"en"});e.data&&(_.value=e.data)}catch{}finally{v.value=!1}},g=()=>{if(p.query.id&&i.value.length>0){const e=i.value.find(a=>a.id==p.query.id);e&&y(e)}};b(()=>p.query.id,()=>{g()}),b(()=>i.value,e=>{e.length>0&&g()});const A=e=>e?new Date(e*1e3).toLocaleDateString(k.value==="zh-CN"?"zh-CN":"en-US"):"--",B=w(()=>{var e;if(!((e=l.value)!=null&&e.body))return"";try{return N.parse(l.value.body)}catch(a){return console.error("Markdown parsing error:",a),l.value.body}}),y=e=>{l.value=e,m.value=!0};return(e,a)=>{const f=C("a-spin"),V=C("a-modal");return r(),o("div",H,[t("div",R,[t("div",U,[d(u(D),{size:32})]),t("h1",null,n(e.$t("dashboard.knowledge.title")),1),t("p",null,n(e.$t("dashboard.knowledge.description")),1)]),v.value?c("",!0):(r(),o("div",j,[(r(!0),o(M,null,T(i.value,s=>(r(),o("div",{key:s.id,class:"knowledge-card glass-card",onClick:de=>y(s)},[t("div",J,[d(u(S),{size:24})]),t("div",P,[t("h3",Q,n(s.title),1),s.description?(r(),o("p",W,n(s.description),1)):c("",!0),t("div",X,[t("span",Y,[d(u(E),{size:14}),$(" "+n(A(s.updated_at||s.created_at)),1)]),s.category?(r(),o("span",Z,n(s.category),1)):c("",!0)])]),t("div",ee,[d(u(I),{size:20})])],8,G))),128))])),v.value?(r(),o("div",te,[d(f,{size:"large"})])):c("",!0),!v.value&&i.value.length===0?(r(),o("div",se,[a[1]||(a[1]=t("div",{class:"empty-icon"},"ðŸ“š",-1)),t("p",null,n(e.$t("dashboard.knowledge.noContent")),1)])):c("",!0),d(V,{visible:m.value,"onUpdate:visible":a[0]||(a[0]=s=>m.value=s),footer:null,width:800,centered:"",class:"knowledge-modal"},{title:z(()=>{var s;return[t("div",ae,[d(u(D),{size:20}),t("span",null,n((s=l.value)==null?void 0:s.title),1)])]}),default:z(()=>[t("div",{class:"modal-content markdown-body",innerHTML:B.value},null,8,oe)]),_:1},8,["visible"])])}}},pe=O(ne,[["__scopeId","data-v-220157a4"]]);export{pe as default};
