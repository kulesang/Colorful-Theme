import{z as k,b as O,u as W,e as r,c as M,h as E,i,j as t,l as o,k as l,t as a,m as h,F as A,w as u,y as N,p as G,s as m,o as d,q as f,B as J}from"./index-DHUON-5F.js";import{v as K,w as Q,x as X,y as Y}from"./user-CGpMpWfC.js";import{U as Z}from"./users-Bu6F_fXw.js";import{W as ss}from"./wallet-COUK7zJy.js";import{P as ts}from"./plus-BVcqCUSV.js";import{C as as}from"./copy-BhQRwH7w.js";import"./request-CTahc_yj.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=k("arrow-right-left",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=k("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=k("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=k("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ds={class:"invitations-page"},rs={class:"page-header"},ls={class:"header-icon"},cs={key:0,class:"loading-state"},vs={class:"invite-stats-grid"},us={class:"stat-card glass-card"},_s={class:"stat-icon commission-count"},hs={class:"stat-content"},ms={class:"stat-value"},ps={class:"stat-label"},ys={class:"stat-card glass-card"},bs={class:"stat-icon commission-earned"},gs={class:"stat-content"},fs={class:"stat-value"},ks={class:"stat-label"},$s={class:"stat-card glass-card"},ws={class:"stat-icon commission-rate"},Cs={class:"stat-content"},zs={class:"stat-value"},Is={class:"stat-label"},Ls={class:"stat-card glass-card highlight balance-card"},As={class:"balance-info"},Ts={class:"stat-icon commission-balance"},Ds={class:"stat-content"},Fs={class:"stat-value"},Ss={class:"stat-label"},Us={class:"balance-action"},Ms={class:"transfer-form"},Ns={class:"transfer-tip"},Ps={class:"amount-input-wrapper"},Vs={class:"input-label"},Bs={class:"amount-actions"},Rs={class:"max-amount"},js={class:"invite-link-card glass-card"},qs={class:"card-header"},xs={key:0,class:"link-box-wrapper"},Hs={class:"code-badge"},Os=["value"],Ws=["onClick"],Es={key:1,class:"empty-codes"},Gs={class:"link-desc"},Js={class:"invite-list-card glass-card"},Ks={class:"card-header"},Qs={class:"record-count"},Xs={class:"record-list"},Ys={key:0,class:"empty-records"},Zs={class:"record-info"},st={class:"record-user"},tt={class:"record-date"},at={key:0,class:"pagination-wrapper"},et={__name:"Invitations",setup(nt){const{t:p}=W(),y=r(null),T=r(!0),$=r(!1),b=r(!1),c=r(null),w=r(!1),P=async()=>{if(!c.value||c.value<1){m.warning(p("dashboard.invitations.minTransfer"));return}w.value=!0;try{(await X({transfer_amount:c.value*100})).data&&(m.success(p("dashboard.invitations.transferSuccess")),b.value=!1,c.value=null,z())}catch{}finally{w.value=!1}},v=M(()=>{var n;if(!((n=y.value)!=null&&n.stat))return{commission_count:0,earned_commission:0,pending_commission:0,commission_rate:0,commission_balance:0};const s=y.value.stat;return{commission_count:s[0]||0,earned_commission:s[1]||0,pending_commission:s[2]||0,commission_rate:s[3]||0,commission_balance:s[4]||0}}),D=M(()=>{var s;return((s=y.value)==null?void 0:s.codes)||[]}),C=r(1),g=r(0),F=r(10),_=r([]),S=async()=>{try{const s=await Q({current:C.value,page_size:F.value});s.data&&Array.isArray(s.data)?(_.value=s.data,g.value=s.total||s.data.length):s.data&&s.data.data&&Array.isArray(s.data.data)?(_.value=s.data.data,g.value=s.data.total):_.value=[]}catch(s){console.error(s)}},U=s=>window.location.origin+"/#/register?code="+s,z=async()=>{try{const s=await K();s.data&&(y.value=s.data)}catch{m.error(p("common.copyFailed"))}finally{T.value=!1}};E(()=>{z(),S()});const V=async()=>{$.value=!0;try{(await Y()).data&&(m.success(p("dashboard.invitations.generateSuccess")),z())}catch{}finally{$.value=!1}},B=s=>s?new Date(s*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"--",R=s=>{navigator.clipboard.writeText(s),m.success("邀请链接已复制")};return(s,n)=>{const j=h("a-spin"),I=h("a-button"),q=h("a-input-number"),x=h("a-modal"),H=h("a-pagination");return d(),i("div",ds,[t("div",rs,[t("div",ls,[o(l(Z),{size:32})]),t("h1",null,a(s.$t("dashboard.invitations.title")),1),t("p",null,a(s.$t("dashboard.invitations.description")),1)]),T.value?(d(),i("div",cs,[o(j,{size:"large"})])):(d(),i(A,{key:1},[t("div",vs,[t("div",us,[t("div",_s,[o(l(is),{size:24})]),t("div",hs,[t("div",ms,a(v.value.commission_count),1),t("div",ps,a(s.$t("dashboard.invitations.stats.count")),1)])]),t("div",ys,[t("div",bs,[o(l(ns),{size:24})]),t("div",gs,[t("div",fs,"¥"+a((v.value.earned_commission/100).toFixed(2)),1),t("div",ks,a(s.$t("dashboard.invitations.stats.earned")),1)])]),t("div",$s,[t("div",ws,[o(l(os),{size:24})]),t("div",Cs,[t("div",zs,a(v.value.commission_rate)+"%",1),t("div",Is,a(s.$t("dashboard.invitations.stats.rate")),1)])]),t("div",Ls,[t("div",As,[t("div",Ts,[o(l(ss),{size:24})]),t("div",Ds,[t("div",Fs,"¥"+a((v.value.commission_balance/100).toFixed(2)),1),t("div",Ss,a(s.$t("dashboard.invitations.stats.balance")),1)])]),t("div",Us,[o(I,{class:"transfer-btn",type:"primary",onClick:n[0]||(n[0]=e=>b.value=!0),disabled:v.value.commission_balance<=0},{icon:u(()=>[o(l(es),{size:16})]),default:u(()=>[f(" "+a(s.$t("dashboard.invitations.transfer")),1)]),_:1},8,["disabled"])])])]),o(x,{visible:b.value,"onUpdate:visible":n[3]||(n[3]=e=>b.value=e),title:s.$t("dashboard.invitations.transferTitle"),onOk:P,confirmLoading:w.value,destroyOnClose:""},{default:u(()=>[t("div",Ms,[t("p",Ns,a(s.$t("dashboard.invitations.transferDesc")),1),t("div",Ps,[t("div",Vs,a(s.$t("dashboard.invitations.transferAmount")),1),o(q,{value:c.value,"onUpdate:value":n[1]||(n[1]=e=>c.value=e),min:1,step:1,style:{width:"100%"},placeholder:"0.00"},{prefix:u(()=>[...n[5]||(n[5]=[f("¥",-1)])]),_:1},8,["value"]),t("div",Bs,[t("span",Rs,a(s.$t("dashboard.invitations.stats.balance"))+": ¥"+a((v.value.commission_balance/100).toFixed(2)),1),o(I,{type:"link",size:"small",onClick:n[2]||(n[2]=e=>c.value=v.value.commission_balance/100)},{default:u(()=>[f(a(s.$t("dashboard.invitations.allTransfer")),1)]),_:1})])])])]),_:1},8,["visible","title","confirmLoading"]),t("div",js,[t("div",qs,[t("h3",null,a(s.$t("dashboard.invitations.linkTitle")),1),o(I,{type:"primary",class:"generate-btn",loading:$.value,onClick:V},{icon:u(()=>[o(l(ts),{size:16})]),default:u(()=>[f(" "+a(s.$t("dashboard.invitations.generate")),1)]),_:1},8,["loading"])]),D.value.length>0?(d(),i("div",xs,[(d(!0),i(A,null,N(D.value,(e,L)=>(d(),i("div",{key:L,class:"link-box"},[t("div",Hs,a(e.code),1),t("input",{value:U(e.code),readonly:"",class:"link-input"},null,8,Os),t("button",{class:"copy-btn",onClick:ot=>R(U(e.code))},[o(l(as),{size:18}),t("span",null,a(s.$t("dashboard.invitations.copy")),1)],8,Ws)]))),128))])):(d(),i("div",Es,[t("p",null,a(s.$t("dashboard.invitations.emptyCode")),1)])),t("p",Gs,a(s.$t("dashboard.invitations.desc")),1)]),t("div",Js,[t("div",Ks,[t("h3",null,a(s.$t("dashboard.invitations.recordTitle")),1),t("span",Qs,a(s.$t("dashboard.invitations.totalRecords",{count:_.value.length})),1)]),t("div",Xs,[_.value.length===0?(d(),i("div",Ys,a(s.$t("dashboard.invitations.noRecords")),1)):(d(!0),i(A,{key:1},N(_.value,(e,L)=>(d(),i("div",{key:L,class:"record-item"},[t("div",Zs,[t("div",st,a(s.$t("dashboard.invitations.orderParams",{id:e.trade_no})),1),t("div",tt,a(s.$t("dashboard.invitations.orderAmount"))+": ¥"+a((e.order_amount/100).toFixed(2))+" | "+a(B(e.created_at)),1)]),t("div",{class:J(["record-status",{confirmed:e.get_amount>0}])},a(e.get_amount>0?`+¥${(e.get_amount/100).toFixed(2)}`:s.$t("dashboard.invitations.statusPending")),3)]))),128))]),g.value>0?(d(),i("div",at,[o(H,{current:C.value,"onUpdate:current":n[4]||(n[4]=e=>C.value=e),total:g.value,pageSize:F.value,onChange:S,"show-less-items":""},null,8,["current","total","pageSize"])])):G("",!0)])],64))])}}},_t=O(et,[["__scopeId","data-v-505d9ae6"]]);export{_t as default};
