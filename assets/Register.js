import{u as F,r as g,a as T,o as j,c as y,b as t,d as _,g as x,t as r,e as o,w as n,f as p,h as M,i as h,j as R,k as E,l as k,m as d}from"./index.js";import{g as P,s as D,r as G}from"./auth.js";import{C as L}from"./Captcha.js";import{_ as H}from"./_plugin-vue_export-helper.js";const J={class:"dark-tech-auth"},K={class:"auth-grid"},O={class:"branding-side"},Q={class:"brand-content"},W={class:"logo-container"},X=["src","alt"],Y={key:1,class:"brand-title"},Z={class:"brand-desc"},ee={class:"features"},ae={class:"feature-badge"},te={class:"feature-badge"},se={class:"form-side"},oe={class:"glass-card form-container"},re={class:"form-header"},le={class:"code-input-group"},ie={class:"form-footer"},ne={href:"#/login",class:"link-primary"},de={__name:"Register",setup(ue){const{t:l}=F(),u=x(),N=M(),w=g(!1),m=g({}),v=g(null),U=e=>{v.value=e},s=T({email:"",password:"",re_password:"",email_code:"",agreement:!0}),f=g(0);let C=null;const V=async()=>{if(!s.email)return d.error(l("validation.emailRequired"));if(u.enableCaptcha&&v.value!==!0)return d.error(l("auth.enterCaptcha"));try{await D({email:s.email}),d.success(l("auth.codeSent")),f.value=60,C=setInterval(()=>{f.value--,f.value<=0&&clearInterval(C)},1e3)}catch(e){d.error(e.message||l("auth.sendFailed"))}};j(async()=>{try{const e=await P();e.data&&(m.value=e.data)}catch(e){console.error("Failed to fetch config:",e)}});const q=async(e,a)=>{if(!a)throw new Error("è¯·æŽ¥å—æœåŠ¡æ¡æ¬¾")},B=async(e,a)=>{if(!a)throw new Error("è¯·è¾“å…¥é‚®ç®±");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))throw new Error(l("validation.emailInvalid"));if(m.value.email_whitelist_suffix&&Array.isArray(m.value.email_whitelist_suffix)){const c=a.split("@")[1];if(!m.value.email_whitelist_suffix.includes(c))throw new Error(l("validation.emailSuffixNotAllowed",{suffixes:m.value.email_whitelist_suffix.join(", ")}))}},I=async e=>{if(u.enableCaptcha){if(v.value===null)return d.error(l("auth.enterCaptcha"));if(v.value===!1)return d.error(l("auth.captchaInvalid"))}if(e.password!==e.re_password)return d.error(l("validation.passwordMismatch"));w.value=!0;try{(await G(e)).data&&(d.success(l("auth.registerSuccess")),N.push("/login"))}catch{}finally{w.value=!1}};return(e,a)=>{const b=p("a-input"),c=p("a-form-item"),$=p("a-button"),S=p("a-input-password"),z=p("a-checkbox"),A=p("a-form");return h(),y("div",J,[t("div",K,[t("div",O,[t("div",Q,[t("div",W,[a[5]||(a[5]=t("div",{class:"logo-glow"},null,-1)),_(u).logoUrl?(h(),y("img",{key:0,src:_(u).logoUrl,alt:_(u).siteName,class:"brand-logo-image"},null,8,X)):(h(),y("h1",Y,"åŠ å…¥ "+r(_(u).siteName),1))]),t("p",Z,r(e.$t("auth.registerSubtitle")),1),t("div",ee,[t("div",ae,[a[6]||(a[6]=t("div",{class:"badge-icon"},"ðŸ›¡ï¸",-1)),t("span",null,r(e.$t("auth.privacyProtection")),1)]),t("div",te,[a[7]||(a[7]=t("div",{class:"badge-icon"},"âš¡",-1)),t("span",null,r(e.$t("auth.unlimitedTraffic")),1)])])])]),t("div",se,[t("div",oe,[t("div",re,[t("h2",null,r(e.$t("auth.registerButton")),1),t("p",null,r(e.$t("auth.registerSubtitle")),1)]),o(A,{model:s,onFinish:I,layout:"vertical"},{default:n(()=>[o(c,{label:e.$t("auth.email"),name:"email",rules:[{validator:B}]},{default:n(()=>[o(b,{value:s.email,"onUpdate:value":a[0]||(a[0]=i=>s.email=i),placeholder:"your@email.com",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),m.value.is_email_verify?(h(),R(c,{key:0,label:"é‚®ç®±éªŒè¯ç ",name:"email_code",rules:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±éªŒè¯ç "}],class:"code-item"},{default:n(()=>[t("div",le,[o(b,{value:s.email_code,"onUpdate:value":a[1]||(a[1]=i=>s.email_code=i),placeholder:"è¾“å…¥éªŒè¯ç ",size:"large"},null,8,["value"]),o($,{type:"primary",class:"send-code-btn",disabled:f.value>0||!s.email,onClick:V},{default:n(()=>[k(r(f.value>0?`${f.value}s`:"å‘é€éªŒè¯ç "),1)]),_:1},8,["disabled"])])]),_:1})):E("",!0),o(c,{label:e.$t("auth.password"),name:"password",rules:[{required:!0,message:e.$t("validation.passwordRequired")}]},{default:n(()=>[o(S,{value:s.password,"onUpdate:value":a[2]||(a[2]=i=>s.password=i),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),o(c,{label:e.$t("auth.confirmPassword"),name:"re_password",rules:[{required:!0,message:e.$t("validation.passwordRequired")}]},{default:n(()=>[o(S,{value:s.re_password,"onUpdate:value":a[3]||(a[3]=i=>s.re_password=i),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),_(u).enableCaptcha?(h(),R(L,{key:1,onVerify:U})):E("",!0),o(c,{name:"agreement",rules:[{validator:q}]},{default:n(()=>[o(z,{checked:s.agreement,"onUpdate:checked":a[4]||(a[4]=i=>s.agreement=i)},{default:n(()=>[k(r(e.$t("auth.agreement")),1)]),_:1},8,["checked"])]),_:1},8,["rules"]),o($,{type:"primary","html-type":"submit",loading:w.value,block:"",size:"large"},{default:n(()=>[k(r(e.$t("auth.registerButton")),1)]),_:1},8,["loading"])]),_:1},8,["model"]),t("div",ie,[t("span",null,r(e.$t("auth.hasAccount")),1),t("a",ne,r(e.$t("auth.backToLogin")),1)])])])])])}}},_e=H(de,[["__scopeId","data-v-9be6be31"]]);export{_e as default};
