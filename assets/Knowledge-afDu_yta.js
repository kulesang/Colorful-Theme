import{u as F,b as u,c as b,f as H,v as K,s as C,h as o,i as s,n as h,k as l,j as v,t as d,F as j,x as I,l as z,w as M,o as n,p as O}from"./index-BHLHUR5A.js";import{d as D,r as T}from"./user-FJ3EB781.js";import{d as N}from"./marked.esm-DajSjiQI.js";import{_ as q}from"./_plugin-vue_export-helper-CmQR6YpH.js";import{B as L}from"./book-open-BDjYBYOn.js";import{c as x}from"./createLucideIcon-x2htp3p0.js";import{C as E,a as S}from"./chevron-right-cBq88083.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=x("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),U={class:"knowledge-page"},G={class:"page-header"},J={class:"header-icon"},P={key:0,class:"knowledge-grid"},Q=["onClick"],W={class:"card-icon"},X={class:"card-content"},Y={class:"card-title"},Z={key:0,class:"card-desc"},ee={class:"card-meta"},te={class:"meta-item"},ae={key:0,class:"category-tag"},se={class:"card-arrow"},oe={key:1,class:"loading-state"},ne={key:2,class:"empty-state"},de={class:"modal-title"},le={class:"modal-content markdown-body"},re={key:0,class:"detail-loading"},ie=["innerHTML"],ce={key:2,class:"empty-detail"},ue={__name:"Knowledge",setup(he){const{locale:k}=F(),f=K();N.setOptions({breaks:!0,gfm:!0,headerIds:!0,mangle:!1});const _=u({}),i=u(!0),g=u(!1),m=u(!1),r=u(null),c=b(()=>{const e=[];return Object.keys(_.value).forEach(t=>{Array.isArray(_.value[t])&&_.value[t].forEach(p=>{e.push({...p,category:t})})}),e});H(async()=>{await A(),y()});const A=async()=>{try{i.value=!0;let e=await D({language:k.value==="zh-CN"?"zh-CN":"en"});(!e.data||Object.keys(e.data).length===0)&&(e=await D()),e.data&&(_.value=e.data)}catch(e){console.error("Fetch knowledge failed:",e)}finally{i.value=!1}},y=()=>{if(f.query.id&&c.value.length>0){const e=c.value.find(t=>t.id==f.query.id);e&&w(e)}};C(()=>f.query.id,()=>{y()}),C(()=>c.value,e=>{e.length>0&&y()});const V=e=>e?new Date(e*1e3).toLocaleDateString(k.value==="zh-CN"?"zh-CN":"en-US"):"--",$=b(()=>{var e;if(!((e=r.value)!=null&&e.body))return"";try{return N.parse(r.value.body)}catch(t){return console.error("Markdown parsing error:",t),r.value.body}}),w=async e=>{r.value={...e},g.value=!0,m.value=!0;try{const t=await T({id:e.id});t.data&&(r.value=t.data)}catch(t){console.error("Fetch article detail failed:",t)}finally{m.value=!1}};return(e,t)=>{const p=z("a-spin"),B=z("a-modal");return n(),o("div",U,[s("div",G,[s("div",J,[l(v(L),{size:32})]),s("h1",null,d(e.$t("dashboard.knowledge.title")),1),s("p",null,d(e.$t("dashboard.knowledge.description")),1)]),i.value?h("",!0):(n(),o("div",P,[(n(!0),o(j,null,I(c.value,a=>(n(),o("div",{key:a.id,class:"knowledge-card glass-card",onClick:ve=>w(a)},[s("div",W,[l(v(R),{size:24})]),s("div",X,[s("h3",Y,d(a.title),1),a.description?(n(),o("p",Z,d(a.description),1)):h("",!0),s("div",ee,[s("span",te,[l(v(E),{size:14}),O(" "+d(V(a.updated_at||a.created_at)),1)]),a.category?(n(),o("span",ae,d(a.category),1)):h("",!0)])]),s("div",se,[l(v(S),{size:20})])],8,Q))),128))])),i.value?(n(),o("div",oe,[l(p,{size:"large"})])):h("",!0),!i.value&&c.value.length===0?(n(),o("div",ne,[t[1]||(t[1]=s("div",{class:"empty-icon"},"ðŸ“š",-1)),s("p",null,d(e.$t("dashboard.knowledge.noContent")),1)])):h("",!0),l(B,{open:g.value,"onUpdate:open":t[0]||(t[0]=a=>g.value=a),footer:null,width:800,centered:"",class:"knowledge-modal"},{title:M(()=>{var a;return[s("div",de,[l(v(L),{size:20}),s("span",null,d((a=r.value)==null?void 0:a.title),1)])]}),default:M(()=>{var a;return[s("div",le,[m.value?(n(),o("div",re,[l(p),s("p",null,d(e.$t("common.loading")),1)])):(a=r.value)!=null&&a.body?(n(),o("div",{key:1,innerHTML:$.value},null,8,ie)):(n(),o("div",ce,d(e.$t("dashboard.knowledge.noContent")),1))])]}),_:1},8,["open"])])}}},we=q(ue,[["__scopeId","data-v-65fd7587"]]);export{we as default};
