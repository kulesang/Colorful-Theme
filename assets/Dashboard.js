import{E as M,u as G,n as P,p as C,r as v,a as Z,o as K,c as l,b as s,e as c,t as o,d as u,k as x,f as z,F as $,y as N,w as R,m as O,h as Y,i as r,v as ss}from"./index.js";import{a as ts,g as es,b as os}from"./user.js";import{d as q,C as A,a as as}from"./marked.esm.js";import{_ as is}from"./_plugin-vue_export-helper.js";import{A as ns}from"./activity.js";import{R as ls}from"./refresh-cw.js";import{Z as rs}from"./zap.js";import{c as cs}from"./createLucideIcon.js";import{C as ds}from"./copy.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=cs("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),us={class:"dark-tech-dashboard"},ms={class:"bento-grid"},hs={class:"subscription-hero glass-card bento-item lg:col-span-8"},ps={key:0,class:"hero-content"},vs={class:"user-meta"},gs={class:"user-titles"},bs={class:"greeting"},_s={class:"plan-tag"},fs={class:"metric-grid"},ws={class:"metric-item glass-card"},ks={class:"m-header"},Ss={class:"m-label"},ys={class:"m-value"},Cs={key:0,class:"m-footer"},xs={class:"m-subtext"},$s={class:"metric-item glass-card"},Ns={class:"m-header"},Os={class:"m-label"},Is={class:"m-value"},Ds={class:"m-footer"},Js={class:"m-subtext"},Ls={class:"metric-item glass-card highlight"},Ts={class:"m-header"},zs={class:"m-label"},Rs={class:"m-value text-primary"},qs={class:"m-footer"},As={class:"m-subtext"},Bs={key:1,class:"hero-skeleton-wrap"},Ms={key:2,class:"hero-empty-state"},js={class:"notification-wall glass-card bento-item lg:col-span-4"},Fs={class:"card-header"},Qs={key:0,class:"notice-list"},Vs=["onClick"],Us={class:"n-body"},Ws={class:"n-title"},Xs={class:"n-time"},Hs={key:1,class:"notice-empty"},Es={class:"subscribe-section glass-card bento-item lg:col-span-12"},Gs={class:"sub-layout"},Ps={class:"sub-left"},Zs={class:"sub-section"},Ks={class:"link-input-group"},Ys=["value"],st={class:"sub-section"},tt={class:"quick-icons"},et={class:"qr-code-box"},ot={class:"sub-right"},at={class:"client-downloads"},it=["href"],nt=["src","alt"],lt={class:"dl-info"},rt={class:"dl-name"},ct={class:"dl-platform"},dt={class:"modal-title-custom"},ut={class:"title-icon"},mt={class:"title-text"},ht={class:"promo-card"},pt={class:"promo-header"},vt=["innerHTML"],gt={class:"promo-body"},bt={class:"promo-desc"},_t={key:0,class:"promo-code-box"},ft={class:"code-label"},wt={class:"code-val"},kt={key:0,class:"promo-action"},St=["innerHTML"],yt={class:"notice-detail-footer"},Ct={class:"info-badge"},xt={components:{AQrcode:M}},$t=Object.assign(xt,{__name:"Dashboard",setup(Nt){q.setOptions({breaks:!0,gfm:!0,headerIds:!0,mangle:!1});const j=Y(),{t:k}=G(),F=P(),Q=C(()=>F.theme==="dark"),a=v(JSON.parse(localStorage.getItem("xboard_subscribe_info")||"null")),g=Z(JSON.parse(localStorage.getItem("xboard_user_info")||'{"email":""}')),b=v({}),_=v(JSON.parse(localStorage.getItem("xboard_notices")||"[]")),m=v(null),f=v(!1),S=v(!1),d=C(()=>{var e;if(!((e=m.value)!=null&&e.content))return null;try{const t=m.value.content.trim();if(t.startsWith("{")&&t.endsWith("}")){const n=JSON.parse(t);if(n&&n.cardComponent)return n}}catch{}return null}),V=C(()=>{var e;if(!((e=m.value)!=null&&e.content)||d.value)return"";try{return q.parse(m.value.content)}catch(t){return console.error("Markdown parsing error:",t),m.value.content}}),U=e=>{m.value=e,f.value=!0},W=e=>{e&&(e.startsWith("http")?window.open(e,"_blank"):(j.push(e),f.value=!1))};K(async()=>{a.value||(S.value=!0),await X(),S.value=!1;try{const e=localStorage.getItem("xboard_client_config");e&&(b.value=JSON.parse(e));const n=await(await fetch("/clientConfig.json")).json();n.downloads&&(b.value=n.downloads,localStorage.setItem("xboard_client_config",JSON.stringify(n.downloads)))}catch{b.value={windows_android:{title:"Windows / Android",clients:[{name:"Clash Verge",platform:"Windows",icon:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Clash.9gwri62wr1.webp",url:"https://clashverge.dev/"},{name:"Surfboard",platform:"Android",icon:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Surfboard.8vn3vv8ggg.svg",url:"https://manual.getsurfboard.com/"}]},macos_ios:{title:"macOS / iOS",clients:[{name:"Clash Verge",platform:"macOS",icon:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Clash.9gwri62wr1.webp",url:"https://clashverge.dev/"},{name:"Shadowrocket",platform:"iOS",icon:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Shadowrocket.8z6ptl1j67.webp",url:"https://apps.apple.com/app/shadowrocket/id932747118"}]}}}});const X=async()=>{try{const[e,t,n]=await Promise.all([ts(),es(),os()]);e.data&&JSON.stringify(e.data)!==JSON.stringify(a.value)&&(a.value=e.data,localStorage.setItem("xboard_subscribe_info",JSON.stringify(e.data))),t.data&&JSON.stringify(t.data)!==JSON.stringify(g)&&(Object.assign(g,t.data),localStorage.setItem("xboard_user_info",JSON.stringify(t.data))),n.data&&JSON.stringify(n.data)!==JSON.stringify(_.value)&&(_.value=n.data,localStorage.setItem("xboard_notices",JSON.stringify(n.data)))}catch{}},H=e=>!e||e<=0?"0 GB":(e/1024**3).toFixed(2)+" GB",E=()=>{var e;(e=a.value)!=null&&e.subscribe_url&&(navigator.clipboard.writeText(a.value.subscribe_url),O.success(k("dashboard.home.copySuccess")))},h=e=>{var w;if(!((w=a.value)!=null&&w.subscribe_url)){O.warning(k("dashboard.home.linkNotReady"));return}const t=encodeURIComponent(a.value.subscribe_url),n={clash:`clash://install-config?url=${t}`,shadowrocket:`shadowrocket://add/sub://${btoa(a.value.subscribe_url)}?remarks=${encodeURIComponent(g.email||"Xboard")}`,"quantumult-x":`quantumult-x:///add-resource?remote-resource=%7B%22server_remote%22:%5B%22${t},tag=Xboard%22%5D%7D`,singbox:`sing-box://import-remote-profile?url=${t}`,surfboard:`surfboard:///install-config?url=${t}`,surge:`surge:///install-config?url=${t}`};n[e]&&(window.location.href=n[e],O.success(k("dashboard.home.jumpingToClient")))};return(e,t)=>{var I,D,J,L,T;const n=z("a-skeleton"),w=z("a-modal");return r(),l("div",us,[s("div",ms,[s("div",hs,[t[8]||(t[8]=s("div",{class:"mesh-glow"},null,-1)),a.value?(r(),l("div",ps,[s("div",vs,[s("div",gs,[s("span",bs,o(e.$t("dashboard.home.greeting",{name:((I=g.email)==null?void 0:I.split("@")[0])||"User"})),1),s("div",_s,[c(u(ns),{size:14}),s("span",null,o(((D=a.value.plan)==null?void 0:D.name)||e.$t("dashboard.home.noPlan")),1)])])]),s("div",fs,[s("div",ws,[s("div",ks,[c(u(A),{size:18,class:"text-accent-purple"}),s("span",Ss,o(e.$t("dashboard.home.expireTime")),1)]),s("span",ys,o(a.value.expired_at?new Date(a.value.expired_at*1e3).toLocaleDateString():e.$t("dashboard.home.forever")),1),a.value.expired_at?(r(),l("div",Cs,[s("span",xs,o(Math.ceil((a.value.expired_at-Date.now()/1e3)/(24*3600)))+" "+o(e.$t("dashboard.home.daysLaterReset")),1)])):x("",!0)]),s("div",$s,[s("div",Ns,[c(u(ls),{size:18,class:"text-accent-blue"}),s("span",Os,o(e.$t("dashboard.home.resetTime")),1)]),s("span",Is,o(e.$t("dashboard.home.resetDate")),1),s("div",Ds,[s("span",Js,o(e.$t("dashboard.home.trafficReset")),1)])]),s("div",Ls,[s("div",Ts,[c(u(rs),{size:18,class:"text-primary"}),s("span",zs,o(e.$t("dashboard.home.remainingTraffic")),1)]),s("span",Rs,o(H(a.value.transfer_enable-(a.value.u+a.value.d))),1),s("div",qs,[s("span",As,o(e.$t("dashboard.home.availableQuota")),1)])])])])):S.value&&!a.value?(r(),l("div",Bs,[c(n,{active:"",paragraph:{rows:3}})])):(r(),l("div",Ms,[s("span",null,o(e.$t("dashboard.home.noDataAvailable")),1)]))]),s("div",js,[s("div",Fs,[c(u(B),{size:18}),s("h3",null,o(e.$t("dashboard.home.importantNotices")),1)]),_.value.length>0?(r(),l("div",Qs,[(r(!0),l($,null,N(_.value,i=>(r(),l("div",{class:"notice-item",key:i.id,onClick:y=>U(i)},[t[9]||(t[9]=s("div",{class:"n-icon"},"ðŸ“Œ",-1)),s("div",Us,[s("span",Ws,o(i.title),1),s("span",Xs,o(new Date(i.created_at*1e3).toLocaleDateString()),1)]),c(u(as),{size:16,class:"n-arrow"})],8,Vs))),128))])):(r(),l("div",Hs,[s("span",null,o(e.$t("dashboard.home.noNotices")),1)]))]),s("div",Es,[s("div",Gs,[s("div",Ps,[s("div",Zs,[s("h4",null,o(e.$t("dashboard.home.subscribeLink")),1),s("div",Ks,[s("input",{readonly:"",value:((J=a.value)==null?void 0:J.subscribe_url)||"https://link.example.com/...",class:"link-input"},null,8,Ys),s("button",{onClick:E,class:"copy-btn"},[c(u(ds),{size:16})])])]),s("div",st,[s("h4",null,o(e.$t("dashboard.home.oneClickImport")),1),s("div",tt,[s("div",{class:"import-item",onClick:t[0]||(t[0]=i=>h("clash"))},[...t[10]||(t[10]=[s("div",{class:"q-icon",title:"Clash"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Clash.9gwri62wr1.webp",alt:"Clash"})],-1),s("span",null,"Clash",-1)])]),s("div",{class:"import-item",onClick:t[1]||(t[1]=i=>h("shadowrocket"))},[...t[11]||(t[11]=[s("div",{class:"q-icon",title:"Shadowrocket"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Shadowrocket.8z6ptl1j67.webp",alt:"Shadowrocket"})],-1),s("span",null,"Shadowrocket",-1)])]),s("div",{class:"import-item",onClick:t[2]||(t[2]=i=>h("singbox"))},[...t[12]||(t[12]=[s("div",{class:"q-icon",title:"Singbox"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Singbox.espc7ryvj.svg",alt:"Singbox"})],-1),s("span",null,"Singbox",-1)])]),s("div",{class:"import-item",onClick:t[3]||(t[3]=i=>h("surfboard"))},[...t[13]||(t[13]=[s("div",{class:"q-icon",title:"Surfboard"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Surfboard.8vn3vv8ggg.svg",alt:"Surfboard"})],-1),s("span",null,"Surfboard",-1)])]),s("div",{class:"import-item",onClick:t[4]||(t[4]=i=>h("surge"))},[...t[14]||(t[14]=[s("div",{class:"q-icon",title:"Surge"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Surge.8s3hy5fdqo.svg",alt:"Surge"})],-1),s("span",null,"Surge",-1)])]),s("div",{class:"import-item",onClick:t[5]||(t[5]=i=>h("quantumult-x"))},[...t[15]||(t[15]=[s("div",{class:"q-icon",title:"Quantumult X"},[s("img",{src:"https://github.com/dc8683/picx-images-hosting/raw/master/rocket/Quantumult.102cyimf66.webp",alt:"Quantumult X"})],-1),s("span",null,"Quantumult X",-1)])]),s("div",et,[c(u(M),{value:((L=a.value)==null?void 0:L.subscribe_url)||"https://xboard.link/placeholder",size:88,color:Q.value?"#F9FAFB":"#1E293B","bg-color":"transparent",status:(T=a.value)!=null&&T.subscribe_url?"active":"loading"},null,8,["value","color","status"]),s("p",null,o(e.$t("dashboard.home.scanToImport")),1)])])])]),s("div",ot,[s("h4",null,o(e.$t("dashboard.home.clientDownload")),1),s("div",at,[(r(!0),l($,null,N(b.value,(i,y)=>(r(),l("div",{key:y,class:"platform-group"},[(r(!0),l($,null,N(i.clients,p=>(r(),l("a",{key:p.name,href:p.url,target:"_blank",class:"download-link"},[s("img",{src:p.icon,alt:p.name},null,8,nt),s("div",lt,[s("span",rt,o(p.name),1),s("span",ct,o(p.platform),1)])],8,it))),128))]))),128))])])])])]),c(w,{visible:f.value,"onUpdate:visible":t[7]||(t[7]=i=>f.value=i),footer:null,width:650,class:"notice-modal",centered:""},{title:R(()=>{var i;return[s("div",dt,[s("div",ut,[c(u(B),{size:18})]),s("span",mt,o((i=m.value)==null?void 0:i.title),1)])]}),default:R(()=>{var i;return[t[16]||(t[16]=s("div",{class:"modal-mesh"},null,-1)),d.value?(r(),l("div",{key:0,class:ss(["promo-card-wrapper",d.value.theme||"default"])},[s("div",ht,[s("div",pt,[s("h2",{class:"promo-title",innerHTML:(i=d.value.title)==null?void 0:i.replace(/\\n/g,"<br>")},null,8,vt)]),s("div",gt,[s("p",bt,o(d.value.content),1),d.value.code?(r(),l("div",_t,[s("span",ft,o(e.$t("dashboard.home.recommendCode")),1),s("span",wt,o(d.value.code),1)])):x("",!0)]),d.value.btnText?(r(),l("div",kt,[s("button",{class:"promo-btn",onClick:t[6]||(t[6]=y=>W(d.value.btnRoute))},o(d.value.btnText),1)])):x("",!0)])],2)):(r(),l("div",{key:1,class:"notice-detail-content markdown-body",innerHTML:V.value},null,8,St)),s("div",yt,[s("div",Ct,[c(u(A),{size:12}),s("span",null,o(m.value?new Date(m.value.created_at*1e3).toLocaleString():""),1)])])]}),_:1},8,["visible"])])}}}),At=is($t,[["__scopeId","data-v-b28f79d7"]]);export{At as default};
