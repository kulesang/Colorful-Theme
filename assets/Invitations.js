import{u as T,r as u,p as m,o as U,c as e,b as s,e as n,d as c,t as a,f as w,F as p,w as z,y as I,m as y,i as o,l as N,v as S}from"./index.js";import{m as B,n as P}from"./user.js";import{_ as R}from"./_plugin-vue_export-helper.js";import{U as V}from"./users.js";import{c as g}from"./createLucideIcon.js";import{W}from"./wallet.js";import{P as j}from"./plus.js";import{C as q}from"./copy.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=g("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=g("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=g("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),H={class:"invitations-page"},J={class:"page-header"},K={class:"header-icon"},O={key:0,class:"loading-state"},Q={class:"invite-stats-grid"},X={class:"stat-card glass-card"},Y={class:"stat-icon commission-count"},Z={class:"stat-content"},ss={class:"stat-value"},ts={class:"stat-label"},as={class:"stat-card glass-card"},es={class:"stat-icon commission-earned"},os={class:"stat-content"},is={class:"stat-value"},ns={class:"stat-label"},cs={class:"stat-card glass-card"},ds={class:"stat-icon commission-rate"},ls={class:"stat-content"},rs={class:"stat-value"},vs={class:"stat-label"},_s={class:"stat-card glass-card highlight"},hs={class:"stat-icon commission-balance"},us={class:"stat-content"},ms={class:"stat-value"},ps={class:"stat-label"},ys={class:"invite-link-card glass-card"},gs={class:"card-header"},bs={key:0,class:"link-box-wrapper"},ks={class:"code-badge"},fs=["value"],$s=["onClick"],Cs={key:1,class:"empty-codes"},ws={class:"link-desc"},zs={class:"invite-list-card glass-card"},Is={class:"card-header"},Fs={class:"record-count"},Ls={class:"record-list"},xs={key:0,class:"empty-records"},Ds={class:"record-info"},Ms={class:"record-user"},Ts={class:"record-date"},Us={__name:"Invitations",setup(Ns){const{t:b}=T(),d=u(null),k=u(!0),v=u(!1),l=m(()=>{var r;if(!((r=d.value)!=null&&r.stat))return{commission_count:0,earned_commission:0,pending_commission:0,commission_rate:0,commission_balance:0};const t=d.value.stat;return{commission_count:t[0]||0,earned_commission:t[1]||0,pending_commission:t[2]||0,commission_rate:t[3]||0,commission_balance:t[4]||0}}),f=m(()=>{var t;return((t=d.value)==null?void 0:t.codes)||[]}),_=m(()=>{var t;return((t=d.value)==null?void 0:t.details)||[]}),$=t=>window.location.origin+"/#/register?code="+t,C=async()=>{try{const t=await B();t.data&&(d.value=t.data)}catch{y.error(b("common.copyFailed"))}finally{k.value=!1}};U(()=>{C()});const F=async()=>{v.value=!0;try{(await P()).data&&(y.success(b("dashboard.invitations.generateSuccess")),C())}catch{}finally{v.value=!1}},L=t=>t?new Date(t*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"--",x=t=>{navigator.clipboard.writeText(t),y.success("邀请链接已复制")};return(t,r)=>{const D=w("a-spin"),M=w("a-button");return o(),e("div",H,[s("div",J,[s("div",K,[n(c(V),{size:32})]),s("h1",null,a(t.$t("dashboard.invitations.title")),1),s("p",null,a(t.$t("dashboard.invitations.description")),1)]),k.value?(o(),e("div",O,[n(D,{size:"large"})])):(o(),e(p,{key:1},[s("div",Q,[s("div",X,[s("div",Y,[n(c(G),{size:24})]),s("div",Z,[s("div",ss,a(l.value.commission_count),1),s("div",ts,a(t.$t("dashboard.invitations.stats.count")),1)])]),s("div",as,[s("div",es,[n(c(A),{size:24})]),s("div",os,[s("div",is,"¥"+a((l.value.earned_commission/100).toFixed(2)),1),s("div",ns,a(t.$t("dashboard.invitations.stats.earned")),1)])]),s("div",cs,[s("div",ds,[n(c(E),{size:24})]),s("div",ls,[s("div",rs,a(l.value.commission_rate)+"%",1),s("div",vs,a(t.$t("dashboard.invitations.stats.rate")),1)])]),s("div",_s,[s("div",hs,[n(c(W),{size:24})]),s("div",us,[s("div",ms,"¥"+a((l.value.commission_balance/100).toFixed(2)),1),s("div",ps,a(t.$t("dashboard.invitations.stats.balance")),1)])])]),s("div",ys,[s("div",gs,[s("h3",null,a(t.$t("dashboard.invitations.linkTitle")),1),n(M,{type:"primary",class:"generate-btn",loading:v.value,onClick:F},{icon:z(()=>[n(c(j),{size:16})]),default:z(()=>[N(" "+a(t.$t("dashboard.invitations.generate")),1)]),_:1},8,["loading"])]),f.value.length>0?(o(),e("div",bs,[(o(!0),e(p,null,I(f.value,(i,h)=>(o(),e("div",{key:h,class:"link-box"},[s("div",ks,a(i.code),1),s("input",{value:$(i.code),readonly:"",class:"link-input"},null,8,fs),s("button",{class:"copy-btn",onClick:Ss=>x($(i.code))},[n(c(q),{size:18}),s("span",null,a(t.$t("dashboard.invitations.copy")),1)],8,$s)]))),128))])):(o(),e("div",Cs,[s("p",null,a(t.$t("dashboard.invitations.emptyCode")),1)])),s("p",ws,a(t.$t("dashboard.invitations.desc")),1)]),s("div",zs,[s("div",Is,[s("h3",null,a(t.$t("dashboard.invitations.recordTitle")),1),s("span",Fs,a(t.$t("dashboard.invitations.totalRecords",{count:_.value.length})),1)]),s("div",Ls,[_.value.length===0?(o(),e("div",xs,a(t.$t("dashboard.invitations.noRecords")),1)):(o(!0),e(p,{key:1},I(_.value,(i,h)=>(o(),e("div",{key:h,class:"record-item"},[s("div",Ds,[s("div",Ms,a(i.email),1),s("div",Ts,a(L(i.created_at)),1)]),s("div",{class:S(["record-status",{confirmed:i.commission>0}])},a(i.commission>0?`+¥${(i.commission/100).toFixed(2)}`:"等待中"),3)]))),128))])])],64))])}}},Es=R(Us,[["__scopeId","data-v-9b8fd76a"]]);export{Es as default};
